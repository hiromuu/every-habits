# システム概要設計書

## 1. システム概要

### 1.1 システム名

Every Habits（エブリーハビッツ）

### 1.2 システムの目的

ユーザーが理想的な朝・夜の習慣を設定し、スマホを使わない時間に健康的な活動を提案するアプリケーション。フィードバック機能により、提案内容を最適化していく。

### 1.3 システムの特徴

- **習慣設定機能**: 朝・夜の理想習慣をカスタマイズ可能
- **AI 提案機能**: GPT API を使用した動的提案生成
- **フィードバック機能**: 3 段階評価による提案最適化
- **ログ機能**: 過去の提案・選択履歴の管理
- **統計機能**: 受容率・拒否率の可視化

### 1.4 対象ユーザー

- 健康的な生活習慣を身につけたい人
- スマホ依存を改善したい人
- 朝・夜の時間を有意義に過ごしたい人

## 2. システム構成

### 2.1 アーキテクチャ

```
┌─────────────────────────────────────────────────────────────┐
│                    プレゼンテーション層                      │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │
│  │   Home      │ │  IdealHabits│ │ Suggestion  │        │
│  │   Screen    │ │   Screen    │ │   Screen    │        │
│  └─────────────┘ └─────────────┘ └─────────────┘        │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│                    アプリケーション層                        │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │
│  │ Suggestion  │ │ UserHabits  │ │ Feedback    │        │
│  │  Service    │ │  Service    │ │  Service    │        │
│  └─────────────┘ └─────────────┘ └─────────────┘        │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│                      ドメイン層                            │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │
│  │ Suggestion  │ │UserIdealHabits│ │ TimeOfDay   │        │
│  │  Entity     │ │   Entity     │ │ValueObject  │        │
│  └─────────────┘ └─────────────┘ └─────────────┘        │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│                  インフラストラクチャ層                      │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐        │
│  │   Firebase  │ │   OpenAI    │ │   Local     │        │
│  │  Repository │ │    API      │ │  Storage    │        │
│  └─────────────┘ └─────────────┘ └─────────────┘        │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 技術スタック

| 項目           | 技術             | バージョン |
| -------------- | ---------------- | ---------- |
| フロントエンド | React Native     | 最新版     |
| 言語           | TypeScript       | 5.x        |
| 状態管理       | Zustand          | 4.x        |
| ナビゲーション | React Navigation | 6.x        |
| バックエンド   | Firebase         | 最新版     |
| AI             | OpenAI GPT API   | 最新版     |
| 開発環境       | Expo             | 最新版     |

## 3. 主要機能

### 3.1 機能一覧

| 機能 ID | 機能名         | 概要                           | 優先度 |
| ------- | -------------- | ------------------------------ | ------ |
| F001    | 理想習慣設定   | 朝・夜の理想習慣を入力・管理   | 高     |
| F002    | 提案表示       | 時間帯に応じた活動提案         | 高     |
| F003    | フィードバック | 3 段階評価によるフィードバック | 高     |
| F004    | ログ表示       | 過去の提案・選択履歴表示       | 中     |
| F005    | 統計表示       | 受容率・拒否率の可視化         | 中     |
| F006    | AI 提案生成    | GPT API による動的提案生成     | 中     |

### 3.2 機能詳細

#### F001: 理想習慣設定

- **入力項目**: 朝の習慣リスト、夜の習慣リスト
- **操作**: 追加、削除、編集
- **保存先**: Firebase Firestore

#### F002: 提案表示

- **表示内容**: タイトル、説明、カテゴリ、タグ
- **フィルタ**: 時間帯（朝・夜）
- **更新**: リアルタイム

#### F003: フィードバック

- **評価**: する（✅）、してもいい（🤔）、したくない（✖️）
- **コメント**: 任意のテキスト入力
- **保存**: 即座に Firebase に保存

## 4. 非機能要件

### 4.1 性能要件

- 画面表示: 3 秒以内
- API 応答: 5 秒以内
- データ保存: 1 秒以内

### 4.2 可用性要件

- 稼働率: 99.5%以上
- メンテナンス時間: 月 1 回、2 時間以内

### 4.3 セキュリティ要件

- ユーザー認証: Firebase Authentication
- データ暗号化: 通信時 TLS、保存時 AES
- API 認証: API キーによる認証

### 4.4 拡張性要件

- ユーザー数: 10,000 人まで対応
- データ量: 1TB まで対応
- 機能追加: モジュール化により容易

## 5. 制約事項

### 5.1 技術制約

- React Native の制限事項
- Firebase の無料プラン制限
- OpenAI API の利用制限

### 5.2 運用制約

- 開発チーム: 1-2 名
- 開発期間: 3 ヶ月
- 予算: 月額$50 以内

## 6. リスク分析

### 6.1 技術リスク

| リスク             | 影響度 | 発生確率 | 対策               |
| ------------------ | ------ | -------- | ------------------ |
| API 制限超過       | 高     | 中       | キャッシュ機能実装 |
| データ損失         | 高     | 低       | バックアップ機能   |
| パフォーマンス低下 | 中     | 中       | 最適化実装         |

### 6.2 運用リスク

| リスク         | 影響度 | 発生確率 | 対策               |
| -------------- | ------ | -------- | ------------------ |
| ユーザー離れ   | 高     | 中       | ユーザビリティ向上 |
| 競合アプリ出現 | 中     | 高       | 差別化機能開発     |
| 法規制変更     | 中     | 低       | 法務チェック       |

## 7. 開発計画

### 7.1 フェーズ別開発

| フェーズ   | 期間   | 主要成果物     |
| ---------- | ------ | -------------- |
| フェーズ 1 | 1 ヶ月 | 基本機能実装   |
| フェーズ 2 | 1 ヶ月 | AI 機能統合    |
| フェーズ 3 | 1 ヶ月 | 最適化・テスト |

### 7.2 マイルストーン

- **M1**: 基本 UI 完成（2 週間）
- **M2**: データ連携完成（4 週間）
- **M3**: AI 機能完成（6 週間）
- **M4**: テスト完了（8 週間）
- **M5**: リリース準備完了（12 週間）
